{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "0a7a5808_41374575",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 106,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-30T21:43:07Z",
      "side": 1,
      "message": "1000 operations. If you perform 1000 comments on the same patch-set, you would eat up all the allowance. Would it automatically discard the older elements? or would it just blow up?",
      "range": {
        "startLine": 106,
        "startChar": 0,
        "endLine": 106,
        "endChar": 12
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "80c5feba_995a90d2",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 106,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-01T07:56:10Z",
      "side": 1,
      "message": "\u003e 1000 operations.\n\nAck\n\nWould it automatically discard the older elements? or would it just blow up?\n\nNope it will not automatically discard older elements, chronicle-map does not support LRU[1]\nAs explained at L82-L83, it will throw an IllegalStateException.\n\n[1]https://github.com/OpenHFT/Chronicle-Map/blob/master/docs/CM_Features.adoc#chronicle-map-does-not-support",
      "parentUuid": "0a7a5808_41374575",
      "range": {
        "startLine": 106,
        "startChar": 0,
        "endLine": 106,
        "endChar": 12
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "69749324_bf092614",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 106,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-05T10:37:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "80c5feba_995a90d2",
      "range": {
        "startLine": 106,
        "startChar": 0,
        "endLine": 106,
        "endChar": 12
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9e8738d7_de5bb276",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 126,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-30T21:43:07Z",
      "side": 1,
      "message": "This has been explained already with the definition of the bloat factor. It isn\u0027t that useful to be copied and pasted all over the place IMHO.",
      "range": {
        "startLine": 125,
        "startChar": 60,
        "endLine": 126,
        "endChar": 18
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "169e731b_a5e06ab9",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 126,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-01T07:56:10Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "9e8738d7_de5bb276",
      "range": {
        "startLine": 125,
        "startChar": 60,
        "endLine": 126,
        "endChar": 18
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4bec2196_7a7169bc",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 146,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-30T21:43:07Z",
      "side": 1,
      "message": "Is there any value in persisting this cache, as it would contain only two values?",
      "range": {
        "startLine": 138,
        "startChar": 0,
        "endLine": 146,
        "endChar": 67
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e113675a_fea2493d",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 146,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-01T07:56:10Z",
      "side": 1,
      "message": "This entry is not necessarily persisted.\nWhether the cache is persisted or not is driven by two factors:\n- `cache.directory` not null\n- `cache.\u003ccache\u003e.diskLimit`, greater than 0\n\nYou can find this logic here[1] and it is similar to the H2 implementation[2].\n\nDocumentation about this cache says[3]:\n```\nIt is not recommended to change the in-memory attributes of this cache away from the defaults. The cache may be persisted by setting diskLimit, which is only recommended if cold start performance is problematic.\n```\n\nWe don\u0027t know upfront if the Gerrit admins decide to persist this cache or not, \nnevertheless these defaults are required and still apply to both in-memory and persisted.\n\nHope it makes sense,\n\n[1]https://gerrit.googlesource.com/modules/cache-chroniclemap/+/refs/heads/master/src/main/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheImpl.java#77\n[2]https://gerrit.googlesource.com/gerrit.git/+/refs/heads/master/java/com/google/gerrit/server/cache/h2/H2CacheFactory.java#167\n[3]https://gerrit-review.googlesource.com/Documentation/config-gerrit.html#cache_names",
      "parentUuid": "4bec2196_7a7169bc",
      "range": {
        "startLine": 138,
        "startChar": 0,
        "endLine": 146,
        "endChar": 67
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dc86125b_bb6d1ec8",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 146,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-05T10:37:28Z",
      "side": 1,
      "message": "@luca, does this make sense?",
      "parentUuid": "e113675a_fea2493d",
      "range": {
        "startLine": 138,
        "startChar": 0,
        "endLine": 146,
        "endChar": 67
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ef002555_e09c6f3e",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 146,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-10-05T12:10:52Z",
      "side": 1,
      "message": "Ah, I know what that is: it is a *unique* entry that points to a map, which is updated. I\u0027m not sure if we support that use-case though.\n\nExample: the cache value gets loaded, then Gerrit updates the pointed map in memory. Do we persist the updated map?",
      "parentUuid": "dc86125b_bb6d1ec8",
      "range": {
        "startLine": 138,
        "startChar": 0,
        "endLine": 146,
        "endChar": 67
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f53655a4_cd5f59ec",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 146,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-05T13:07:39Z",
      "side": 1,
      "message": "This cache is not persisted by default, but I do not think it matters whether it is or not.\nDefaults need to be provided for all caches (see reply regarding kind_change).",
      "parentUuid": "ef002555_e09c6f3e",
      "range": {
        "startLine": 138,
        "startChar": 0,
        "endLine": 146,
        "endChar": 67
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b16f34a2_2483c43f",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 163,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-30T21:43:07Z",
      "side": 1,
      "message": "What does that mean exactly?",
      "range": {
        "startLine": 162,
        "startChar": 29,
        "endLine": 163,
        "endChar": 7
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3659cecc_11cd554f",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 163,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-01T07:56:10Z",
      "side": 1,
      "message": "Good question ðŸ˜Š\nthis cache is not documented in the standard cache documentation[2], however it\nis used and needs to be tuned.\nThis is the only documentation I found regarding this[1].\n\nIt seems this caches the *kind* of a commit, where \"kind\" defines some type, such as:\n\"this commit is a trival rebase\", \"this commit is a rework\", etc\n\nDo you have more details on this? I could improve this documentation.\n\n\n[1] https://gerrit.googlesource.com/gerrit.git/+/refs/heads/master/java/com/google/gerrit/extensions/client/ChangeKind.java#17\n[2] https://gerrit-review.googlesource.com/Documentation/config-gerrit.html#cache_names",
      "parentUuid": "b16f34a2_2483c43f",
      "range": {
        "startLine": 162,
        "startChar": 29,
        "endLine": 163,
        "endChar": 7
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "13eabc22_afea9c9b",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 163,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-05T10:37:28Z",
      "side": 1,
      "message": "@luca, any suggestion?",
      "parentUuid": "3659cecc_11cd554f",
      "range": {
        "startLine": 162,
        "startChar": 29,
        "endLine": 163,
        "endChar": 7
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "988239b0_64c82827",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 163,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-10-05T12:10:52Z",
      "side": 1,
      "message": "\u003e @luca, any suggestion?\n\nIf the cache isn\u0027t documented, it means a Gerrit admin isn\u0027t supposed to configure it. Is this cache persisted to disk by default? If not, then it isn\u0027t something we should be worried about, as it designed and intended to be used in memory only.",
      "parentUuid": "13eabc22_afea9c9b",
      "range": {
        "startLine": 162,
        "startChar": 29,
        "endLine": 163,
        "endChar": 7
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "99b3f769_c1b4c66a",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 163,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-05T13:07:39Z",
      "side": 1,
      "message": "\u003e If the cache isn\u0027t documented, it means a Gerrit admin isn\u0027t supposed to configure it.\n\u003e Is this cache persisted to disk by default? If not, then it isn\u0027t something we should be worried about, as it designed and intended to be used in memory only.\n\nWhat do you mean by \"be worried about\"?\nThis change is not for persisted only caches, but for both.\n\nThe configuration that needs to be provided is the same, regardless whether the cache is going to be persisted or not: entries, maxBloatFactor, averageKeySize, averageValueSize.\n\n1 - Too small entries/bloatFactor: value will throw an IllegalStateException, for in-memory only *and* persisted caches.\n\n2 - Over/Under fitting key/value sizes will slow down performances, for in-memory only *and* persisted caches.\n\nIf we were not providing sensible defaults for all caches, we might encounter 1 and 2, regardless their persistence status.\n\nDoes it make sense?",
      "parentUuid": "988239b0_64c82827",
      "range": {
        "startLine": 162,
        "startChar": 29,
        "endLine": 163,
        "endChar": 7
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e4ec6028_965f00c4",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 163,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-05T13:19:15Z",
      "side": 1,
      "message": "I have removed the change_kind from the documentation (as you mentioned we don\u0027t want the admin user to know about this), but left its defaults in the defaults map.",
      "parentUuid": "99b3f769_c1b4c66a",
      "range": {
        "startLine": 162,
        "startChar": 29,
        "endLine": 163,
        "endChar": 7
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cb3224a2_1e0acd0d",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 171,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-30T21:43:07Z",
      "side": 1,
      "message": "Capital \u0027C\u0027",
      "range": {
        "startLine": 171,
        "startChar": 0,
        "endLine": 171,
        "endChar": 1
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "180a6b3e_eb7a5a8a",
        "filename": "config.md",
        "patchSetId": 3
      },
      "lineNbr": 171,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-01T07:56:10Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "cb3224a2_1e0acd0d",
      "range": {
        "startLine": 171,
        "startChar": 0,
        "endLine": 171,
        "endChar": 1
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c32beffe_2ac57d39",
        "filename": "src/main/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfig.java",
        "patchSetId": 3
      },
      "lineNbr": 152,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-09-30T21:43:07Z",
      "side": 1,
      "message": "Are these general defaults documented somewhere?",
      "range": {
        "startLine": 147,
        "startChar": 0,
        "endLine": 152,
        "endChar": 57
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "55c2990a_75d0ce70",
        "filename": "src/main/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfig.java",
        "patchSetId": 3
      },
      "lineNbr": 152,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-01T07:56:10Z",
      "side": 1,
      "message": "Nope, good point. Let me do that.",
      "parentUuid": "c32beffe_2ac57d39",
      "range": {
        "startLine": 147,
        "startChar": 0,
        "endLine": 152,
        "endChar": 57
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bcd64d32_9e415d9c",
        "filename": "src/main/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfig.java",
        "patchSetId": 3
      },
      "lineNbr": 152,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2020-10-05T10:37:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "55c2990a_75d0ce70",
      "range": {
        "startLine": 147,
        "startChar": 0,
        "endLine": 152,
        "endChar": 57
      },
      "revId": "d53b1ea4f18c5c3755a2f1be4517750e8f377e28",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}