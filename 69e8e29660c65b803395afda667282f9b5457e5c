{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "5594eeda_ed059e33",
        "filename": "src/main/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfig.java",
        "patchSetId": 1
      },
      "lineNbr": 253,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-09-13T07:15:16Z",
      "side": 1,
      "message": "This is unrelated to this CR, but as a follow up I think we should warn in the logs if the generic `default` is applied.\n\nThis CR will cover adding defaults for all core caches, but we have no visibility on the ones introduced by plugins.\n\nWe should find a way to tell the gerrit admin that those need tuning.\n\nWDYT?",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5d696896_786ecf1e",
        "filename": "src/main/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfig.java",
        "patchSetId": 1
      },
      "lineNbr": 253,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2022-09-13T12:45:06Z",
      "side": 1,
      "message": "Good point that we discussed too ;) I will address that in a dedicated CR.",
      "parentUuid": "5594eeda_ed059e33",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "209de557_21043419",
        "filename": "src/main/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfig.java",
        "patchSetId": 1
      },
      "lineNbr": 253,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2022-09-14T06:42:29Z",
      "side": 1,
      "message": "Addressed in `I8b0835c6d8` that this change was rebased over.",
      "parentUuid": "5d696896_786ecf1e",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "303b25ba_09957440",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 46,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-09-13T07:15:16Z",
      "side": 1,
      "message": "Why setting `diskLimit`? AFAIR this is ignored by chroniclemap, no?",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 46,
        "endChar": 67
      },
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "09155552_6c390615",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 46,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2022-09-13T12:45:06Z",
      "side": 1,
      "message": "That is correct. It gets ignored but AFAIU it is the only way to enable in Gerrit persistency/caches in question",
      "parentUuid": "303b25ba_09957440",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 46,
        "endChar": 67
      },
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5eeac0b6_918a866c",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 46,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-09-14T07:07:27Z",
      "side": 1,
      "message": "Oh I see, good point!\nCould we perhaps add a comment to explain that those caches are not persistent by default and thus this is done to ensure a `.dat` file is created for traversal?",
      "parentUuid": "09155552_6c390615",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 46,
        "endChar": 67
      },
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2bdba912_3d4adae2",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 46,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2022-09-20T07:00:23Z",
      "side": 1,
      "message": "description added",
      "parentUuid": "5eeac0b6_918a866c",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 46,
        "endChar": 67
      },
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8e64b70e_009fa25a",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-09-13T07:15:16Z",
      "side": 1,
      "message": "aren\u0027t `dat` files created as soon as the chronicle-map store comes into existance?",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f3aee0c1_3b9316c4",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2022-09-13T12:45:06Z",
      "side": 1,
      "message": "they mostly are, but `web_sessions` isn\u0027t",
      "parentUuid": "8e64b70e_009fa25a",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6e6e87ef_f92d3102",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-09-14T07:07:27Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "f3aee0c1_3b9316c4",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a218554b_f4f9b38c",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-09-13T07:15:16Z",
      "side": 1,
      "message": "Are you planning to add the defaults for these missing ones as part of this CR then?",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4cc86c2d_b8721d38",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2022-09-13T12:45:06Z",
      "side": 1,
      "message": "I wanted to split it up as it may take some time to actually find it. Lets see if/when I will get those defaults ;)",
      "parentUuid": "a218554b_f4f9b38c",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "eadd194c_0fac70f1",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-09-14T07:07:27Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "4cc86c2d_b8721d38",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2221125f_be0dedad",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 84,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-09-13T07:15:16Z",
      "side": 1,
      "message": "If this method returns an empty set, the test will pass because `containsExactlyElementsIn` will always return `true`.\n\nHow about `fail` or `throw` instead to signal that our expectations have not been met?",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "33206d5f_980c69cc",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 84,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2022-09-13T12:45:06Z",
      "side": 1,
      "message": "The test will not pass as `Defaults.defaultMap` contains entries and `containsExactlyElementsIn` as per definition:\n\n```\n(...) Checks that a subject contains exactly the provided objects or fails.\n```\n\nIOW when `value` has entries and `expected` is empty it will fail with\n```\nvalue of: keySet()\nexpected to be empty\nbut was : [web_sessions, change_notes, accounts, diff, diff_intraline, diff_summary, external_ids_map, oauth_tokens, change_kind, mergeability, pure_revert, persisted_projects, conflicts]\n\tat com.googlesource.gerrit.modules.cache.chroniclemap.ChronicleMapCacheConfigDefaultsIT.shouldAllPersistentCachesHaveDefaultConfiguration(ChronicleMapCacheConfigDefaultsIT.java:64)\n\n```",
      "parentUuid": "2221125f_be0dedad",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "db4f2e87_6d2e60d9",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 88,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2022-09-13T07:15:16Z",
      "side": 1,
      "message": "nit: have you considered using `FilenameUtils.removeExtension`?",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "eba189f3_4f7e8f7a",
        "filename": "src/test/java/com/googlesource/gerrit/modules/cache/chroniclemap/ChronicleMapCacheConfigDefaultsIT.java",
        "patchSetId": 1
      },
      "lineNbr": 88,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2022-09-13T12:45:06Z",
      "side": 1,
      "message": "I did, but the problem is that it shaves off the last extension and `H2_SUFFIX` has two IOW cache file looks like `web_sessions.h2.db` and after `removeExtension` application it results in `web_sessions.h2` which is not desired from test perspecitve ;) Alternative would be to call it 2 times but my eyes would bleed on that 😊",
      "parentUuid": "db4f2e87_6d2e60d9",
      "revId": "69e8e29660c65b803395afda667282f9b5457e5c",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}