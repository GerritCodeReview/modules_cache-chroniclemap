{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "3d21b355_c4a4a4bf",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 16
      },
      "lineNbr": 0,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-02-11T14:13:19Z",
      "side": 1,
      "message": "Tested this against gerrithub caches and it breaks for two caches:\n\n1)\n```\nMigrating H2 caches to Chronicle-Map...\n* Size multiplier: 3\n* Max Bloat Factor: 3\nFATAL: error migrating git_tags H2 cache\nfatal: Hexadecimal string with odd number of characters: \"SpaceKnow/backend\" [90003-176]\n```\n\nThis is to do with deserialization of string keys. I have already a fix for it and I am going to push it soon.\n\n2)\n```\nMigrating H2 caches to Chronicle-Map...\n* Size multiplier: 3\n* Max Bloat Factor: 3\n[accounts]:             100% (1/1)\n[diff]:                  19% ( 9536/50189)FATAL: error migrating diff H2 cache\nfatal: ChronicleMap{name\u003ddiff, file\u003d/Users/syntonyze/ginstall/gerrit-3.3/cache/diff_0.dat, identityHashCode\u003d1677415237}: Entry is too large: requires 9534 chunks, 8313 is maximum.\n```\n\nThis is caused by this change[1] which is really big and an outlier compared to the average keys/values for this cache, which is computed as follows:\n\navgKeySize \u003d 188\navgValueSize \u003d 2511\n\nThis entry value size is: 9762544 bytes (9.76 Mb), which is 3800 times the average value of 2511.\n\nChanging the size multiplier from 3 to 4, to allow a greater chunk allocation allows the migration to run successfully.\n\nSome caches have a predictable size (because their object serialization length is always the same, see for example \"mergeability\" or \"accounts\"), but others are more variable (such as \"diff\"). For those caches we should allocate more size.\n\nWDYT?\n\n[1]https://review.gerrithub.io/c/SRiderEv/Xemelgo/+/491004",
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e7ec0a4d_62bbd785",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 16
      },
      "lineNbr": 0,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-02-11T14:40:15Z",
      "side": 1,
      "message": "The e",
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e9f61cf1_cf12da5d",
        "filename": "README.md",
        "patchSetId": 16
      },
      "lineNbr": 28,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-02-11T00:58:47Z",
      "side": 1,
      "message": "Migration from H2 caches",
      "range": {
        "startLine": 28,
        "startChar": 3,
        "endLine": 28,
        "endChar": 12
      },
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7ae41035_ded59afd",
        "filename": "README.md",
        "patchSetId": 16
      },
      "lineNbr": 30,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-02-11T00:58:47Z",
      "side": 1,
      "message": "src/main/resources/Documentation/migration.md",
      "range": {
        "startLine": 30,
        "startChar": 61,
        "endLine": 30,
        "endChar": 75
      },
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2505abd2_e9c55e76",
        "filename": "README.md",
        "patchSetId": 16
      },
      "lineNbr": 30,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-02-11T15:47:12Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7ae41035_ded59afd",
      "range": {
        "startLine": 30,
        "startChar": 61,
        "endLine": 30,
        "endChar": 75
      },
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "20ec80f7_ff7f57d2",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-02-11T00:58:47Z",
      "side": 1,
      "message": "This should be in src/main/resources/Documentation/migration.md",
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "de62c081_3471a954",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 0,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-02-11T14:40:15Z",
      "side": 1,
      "message": "There is no resources directory in this module, all the docs are in the root.\nI will move them all in a follow up change, is that OK?",
      "parentUuid": "20ec80f7_ff7f57d2",
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5f903215_536746bc",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 0,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-02-11T15:47:12Z",
      "side": 1,
      "message": "Done.",
      "parentUuid": "de62c081_3471a954",
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4957a96c_c5925722",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 3,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-02-11T00:58:47Z",
      "side": 1,
      "message": "converting existing cache from",
      "range": {
        "startLine": 3,
        "startChar": 44,
        "endLine": 3,
        "endChar": 58
      },
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3e36e079_4fdd479a",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 3,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-02-11T14:40:15Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4957a96c_c5925722",
      "range": {
        "startLine": 3,
        "startChar": 44,
        "endLine": 3,
        "endChar": 58
      },
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "354de03e_5d638baf",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 6,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-02-11T00:58:47Z",
      "side": 1,
      "message": "must",
      "range": {
        "startLine": 6,
        "startChar": 14,
        "endLine": 6,
        "endChar": 20
      },
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9b28d14e_6a5ca85e",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 6,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-02-11T14:40:15Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "354de03e_5d638baf",
      "range": {
        "startLine": 6,
        "startChar": 14,
        "endLine": 6,
        "endChar": 20
      },
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6e8997d4_7c5cee44",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 7,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-02-11T00:58:47Z",
      "side": 1,
      "message": "You should also specify that for migrating to chronicle-map, the libModule needs to be installed as a plugin, isn\u0027t it?",
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b23dcedf_a93414c9",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 7,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-02-11T14:40:15Z",
      "side": 1,
      "message": "I say this at L16, when I describe step by step how to perform the migration.\nIf you think is not clear I will highlight it here as well.",
      "parentUuid": "6e8997d4_7c5cee44",
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "080f4361_13899610",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 16,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-02-11T00:58:47Z",
      "side": 1,
      "message": "Copy",
      "range": {
        "startLine": 16,
        "startChar": 2,
        "endLine": 16,
        "endChar": 6
      },
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "78154159_1950968b",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 16,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-02-11T14:40:15Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "080f4361_13899610",
      "range": {
        "startLine": 16,
        "startChar": 2,
        "endLine": 16,
        "endChar": 6
      },
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6a5b5ebb_64b637a1",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 17,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2021-02-11T00:58:47Z",
      "side": 1,
      "message": "to load",
      "range": {
        "startLine": 17,
        "startChar": 28,
        "endLine": 17,
        "endChar": 51
      },
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b72c8dd1_06c59efe",
        "filename": "migration.md",
        "patchSetId": 16
      },
      "lineNbr": 17,
      "author": {
        "id": 1072905
      },
      "writtenOn": "2021-02-11T14:40:15Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6a5b5ebb_64b637a1",
      "range": {
        "startLine": 17,
        "startChar": 28,
        "endLine": 17,
        "endChar": 51
      },
      "revId": "77f8735a702608ec09aa7bb72a0f295c56a1fd00",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}